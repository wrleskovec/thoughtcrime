'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

var _lodash = require('lodash.isarray');

var _lodash2 = _interopRequireDefault(_lodash);

var _lodash3 = require('lodash.isobject');

var _lodash4 = _interopRequireDefault(_lodash3);

var _lodash5 = require('lodash.merge');

var _lodash6 = _interopRequireDefault(_lodash5);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }

exports['default'] = function (oldState, newState) {
    var result = _extends({}, oldState);

    for (var key in newState) {
        if (!newState.hasOwnProperty(key)) {
            continue;
        }
        var value = newState[key];

        // Assign if we don't need to merge at all
        if (!result.hasOwnProperty(key)) {
            result[key] = (0, _lodash4['default'])(value) && !(0, _lodash2['default'])(value) ? (0, _lodash6['default'])({}, value) : value;
            continue;
        }

        var oldValue = result[key];

        if ((0, _lodash4['default'])(value) && !(0, _lodash2['default'])(value)) {
            result[key] = (0, _lodash6['default'])({}, oldValue, value);
        } else {
            result[key] = value;
        }
    }

    return result;
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9pbmRleC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUFBOzs7O0FBQ0E7Ozs7QUFDQTs7Ozs7O3FCQUVlLFVBQUMsUUFBRCxFQUFXLFFBQVgsRUFBd0I7QUFDbkMsUUFBTSxzQkFBYyxRQUFkLENBQU47O0FBRUEsU0FBSyxJQUFNLEdBQVgsSUFBa0IsUUFBbEIsRUFBNEI7QUFDeEIsWUFBSSxDQUFDLFNBQVMsY0FBVCxDQUF3QixHQUF4QixDQUFMLEVBQW1DO0FBQy9CO0FBQ0g7QUFDRCxZQUFNLFFBQVEsU0FBUyxHQUFULENBQWQ7OztBQUdBLFlBQUksQ0FBQyxPQUFPLGNBQVAsQ0FBc0IsR0FBdEIsQ0FBTCxFQUFpQztBQUM3QixtQkFBTyxHQUFQLElBQWMseUJBQVMsS0FBVCxLQUFtQixDQUFDLHlCQUFRLEtBQVIsQ0FBcEIsR0FDUix5QkFBTSxFQUFOLEVBQVUsS0FBVixDQURRLEdBRVIsS0FGTjtBQUdBO0FBQ0g7O0FBRUQsWUFBTSxXQUFXLE9BQU8sR0FBUCxDQUFqQjs7QUFFQSxZQUFJLHlCQUFTLEtBQVQsS0FBbUIsQ0FBQyx5QkFBUSxLQUFSLENBQXhCLEVBQXdDO0FBQ3BDLG1CQUFPLEdBQVAsSUFBYyx5QkFBTSxFQUFOLEVBQVUsUUFBVixFQUFvQixLQUFwQixDQUFkO0FBQ0gsU0FGRCxNQUVPO0FBQ0gsbUJBQU8sR0FBUCxJQUFjLEtBQWQ7QUFDSDtBQUNKOztBQUVELFdBQU8sTUFBUDtBQUNILEMiLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgaXNBcnJheSBmcm9tICdsb2Rhc2guaXNhcnJheSc7XG5pbXBvcnQgaXNPYmplY3QgZnJvbSAnbG9kYXNoLmlzb2JqZWN0JztcbmltcG9ydCBtZXJnZSBmcm9tICdsb2Rhc2gubWVyZ2UnO1xuXG5leHBvcnQgZGVmYXVsdCAob2xkU3RhdGUsIG5ld1N0YXRlKSA9PiB7XG4gICAgY29uc3QgcmVzdWx0ID0geyAuLi5vbGRTdGF0ZSB9O1xuXG4gICAgZm9yIChjb25zdCBrZXkgaW4gbmV3U3RhdGUpIHtcbiAgICAgICAgaWYgKCFuZXdTdGF0ZS5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCB2YWx1ZSA9IG5ld1N0YXRlW2tleV07XG5cbiAgICAgICAgLy8gQXNzaWduIGlmIHdlIGRvbid0IG5lZWQgdG8gbWVyZ2UgYXQgYWxsXG4gICAgICAgIGlmICghcmVzdWx0Lmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgICAgICAgIHJlc3VsdFtrZXldID0gaXNPYmplY3QodmFsdWUpICYmICFpc0FycmF5KHZhbHVlKVxuICAgICAgICAgICAgICAgID8gbWVyZ2Uoe30sIHZhbHVlKVxuICAgICAgICAgICAgICAgIDogdmFsdWU7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IG9sZFZhbHVlID0gcmVzdWx0W2tleV07XG5cbiAgICAgICAgaWYgKGlzT2JqZWN0KHZhbHVlKSAmJiAhaXNBcnJheSh2YWx1ZSkpIHtcbiAgICAgICAgICAgIHJlc3VsdFtrZXldID0gbWVyZ2Uoe30sIG9sZFZhbHVlLCB2YWx1ZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXN1bHRba2V5XSA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc3VsdDtcbn07XG4iXX0=